#!/bin/bash
# Use ./build web to build just web module and deploy, ./build core to build core, than web and deploy.

ARG=$1

if [[ $ARG = "web" ]]; then
    mvn -f learn-english-web/pom.xml clean install
fi

if [[ $ARG = "core" ]]; then
    mvn -f learn-english-core/pom.xml clean install
    STATUS1=$?
    if [ $STATUS1 -eq 0 ]; then
        mvn -f learn-english-web/pom.xml clean install

        STATUS=$?
        if [ $STATUS -eq 0 ]; then
            sh /home/yaroslav/usr/glassfish4/bin/asadmin redeploy --name learn-english-web-1.0-SNAPSHOT /home/yaroslav/workspace/LearnEnglishWithMovies/learn-english-web/target/learn-english-web-1.0-SNAPSHOT.war
        fi
    fi
        exit
fi

if [[ $ARG = "parser" ]]; then
    mvn -f learn-english-subtitles-parser/pom.xml clean install
    STATUS1=$?
    if [ $STATUS1 -eq 0 ]; then
        mvn -f learn-english-web/pom.xml clean install

        STATUS=$?
        if [ $STATUS -eq 0 ]; then
            sh /home/yaroslav/usr/glassfish4/bin/asadmin redeploy --name learn-english-web-1.0-SNAPSHOT /home/yaroslav/workspace/LearnEnglishWithMovies/learn-english-web/target/learn-english-web-1.0-SNAPSHOT.war
        fi
    fi
        exit
fi

if [[ $ARG = "translator" ]]; then
    mvn -f learn-english-translator/pom.xml clean install
    STATUS1=$?
    if [ $STATUS1 -eq 0 ]; then
        mvn -f learn-english-web/pom.xml clean install

        STATUS=$?
        if [ $STATUS -eq 0 ]; then
            sh /home/yaroslav/usr/glassfish4/bin/asadmin redeploy --name learn-english-web-1.0-SNAPSHOT /home/yaroslav/workspace/LearnEnglishWithMovies/learn-english-web/target/learn-english-web-1.0-SNAPSHOT.war
        fi
    fi
        exit
fi

if [ $# -eq 0 ]; then
    mvn clean install
fi

STATUS=$?
if [ $STATUS -eq 0 ]; then
sh /home/yaroslav/usr/glassfish4/bin/asadmin deploy --name learn-english-web-1.0-SNAPSHOT /home/yaroslav/workspace/LearnEnglishWithMovies/learn-english-web/target/learn-english-web-1.0-SNAPSHOT.war
fi

